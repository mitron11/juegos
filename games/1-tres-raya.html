<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tres en Raya Pro | Fix</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">
    <style>
        :root {
            --fondo: #102C26;
            --tarjeta: #F7EFCE;
            --primario: #e91e63;
            --texto: #ffffff;
        }

        body { 
            font-family: 'Bungee', cursive; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            background: var(--fondo); 
            color: var(--texto);
            margin: 0;
            padding: 20px;
        }

        h1 { color: var(--tarjeta); text-shadow: 3px 3px 0px var(--primario); }

        .controls { 
            background: var(--tarjeta); 
            padding: 15px; 
            border-radius: 12px; 
            border: 4px solid var(--primario);
            width: 90%; max-width: 320px;
            color: #102C26;
            margin-bottom: 20px;
        }

        select { 
            width: 100%; padding: 8px; margin: 5px 0; 
            background: var(--fondo); color: white; 
            border: 2px solid var(--primario); font-family: 'Bungee';
        }

        .board { 
            display: grid; 
            grid-template-columns: repeat(3, 100px); 
            grid-gap: 10px; 
            background: var(--tarjeta); 
            padding: 15px; 
            border-radius: 15px;
            box-shadow: 8px 8px 0px var(--primario);
        }

        .cell { 
            width: 100px; 
            height: 100px; 
            background: #ffffff; 
            border: 2px solid #ccc; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 3.5rem; /* Tamaño grande para que se vea bien */
            cursor: pointer; 
            border-radius: 10px;
            transition: 0.2s;
        }

        /* COLORES CLAVE PARA QUE APAREZCAN */
        .cell.x-color { 
            color: var(--primario) !important; 
            text-shadow: 2px 2px 0px #880e4f;
        }

        .cell.o-color { 
            color: var(--fondo) !important; 
            text-shadow: 1px 1px 0px #000;
        }

        .cell:hover:not(.taken) { background: #eee; }
        .cell.taken { cursor: not-allowed; }

        .status { margin-top: 20px; font-size: 1.5rem; color: var(--tarjeta); }

        button { 
            margin-top: 10px; padding: 10px 20px; 
            background: var(--primario); color: white; 
            border: none; border-radius: 8px; font-family: 'Bungee';
            box-shadow: 4px 4px 0px #5a0a33;
        }
    </style>
</head>
<body>

    <h1>TRES EN RAYA</h1>

    <div class="controls">
        <label>MODO</label>
        <select id="gameMode" onchange="resetGame()">
            <option value="pvp">AMIGOS</option>
            <option value="pvc">CONTRA IA</option>
        </select>
        <button onclick="resetGame()">REINICIAR</button>
    </div>

    <div class="board" id="board">
        <div class="cell" onclick="makeMove(0)"></div>
        <div class="cell" onclick="makeMove(1)"></div>
        <div class="cell" onclick="makeMove(2)"></div>
        <div class="cell" onclick="makeMove(3)"></div>
        <div class="cell" onclick="makeMove(4)"></div>
        <div class="cell" onclick="makeMove(5)"></div>
        <div class="cell" onclick="makeMove(6)"></div>
        <div class="cell" onclick="makeMove(7)"></div>
        <div class="cell" onclick="makeMove(8)"></div>
    </div>

    <div class="status" id="status">TURNO DE X</div>

    <script>
        let board = ['', '', '', '', '', '', '', '', ''];
        let currentPlayer = 'X';
        let gameActive = true;

        function makeMove(index) {
            if (board[index] !== '' || !gameActive) return;
            
            board[index] = currentPlayer;
            updateBoard();

            if (checkWin(board, currentPlayer)) {
                document.getElementById('status').innerText = "¡GANÓ LA " + currentPlayer + "!";
                gameActive = false;
                return;
            }
            if (board.every(cell => cell !== '')) {
                document.getElementById('status').innerText = "¡EMPATE!";
                gameActive = false;
                return;
            }

            currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
            document.getElementById('status').innerText = "TURNO DE " + currentPlayer;

            if (document.getElementById('gameMode').value === 'pvc' && currentPlayer === 'O') {
                setTimeout(aiMove, 500);
            }
        }

        function updateBoard() {
            const cells = document.querySelectorAll('.cell');
            board.forEach((val, i) => {
                cells[i].innerText = val;
                cells[i].classList.remove('x-color', 'o-color', 'taken');
                if (val === 'X') cells[i].classList.add('x-color', 'taken');
                if (val === 'O') cells[i].classList.add('o-color', 'taken');
            });
        }

        function checkWin(b, p) {
            const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
            return wins.some(c => c.every(i => b[i] === p));
        }

        function resetGame() {
            board = ['', '', '', '', '', '', '', '', ''];
            currentPlayer = 'X';
            gameActive = true;
            document.getElementById('status').innerText = "TURNO DE X";
            updateBoard();
        }

        // Lógica simple de IA para probar rápido
        function aiMove() {
            let empty = board.map((v, i) => v === '' ? i : null).filter(v => v !== null);
            if (empty.length > 0) {
                let move = empty[Math.floor(Math.random() * empty.length)];
                makeMove(move);
            }
        }
    </script>
</body>
</html>
