<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Racer | Suite Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">
    <style>
        :root {
            --fondo: #102C26;
            --tarjeta: #F7EFCE;
            --primario: #e91e63;
            --carretera: #222;
        }

        body {
            margin: 0;
            background: var(--fondo);
            color: var(--tarjeta);
            font-family: 'Bungee', cursive;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        canvas {
            border: 4px solid var(--tarjeta);
            background: #000;
            box-shadow: 10px 10px 0px var(--primario);
            cursor: none;
        }

        .ui {
            margin-bottom: 10px;
            font-size: 1.2rem;
            display: flex;
            gap: 20px;
        }

        .back-link { margin-top: 20px; color: var(--tarjeta); text-decoration: none; font-size: 0.8rem; border-bottom: 2px solid var(--primario); }
    </style>
</head>
<body>

    <div class="ui">
        <div>KM: <span id="dist">0</span></div>
        <div style="color: var(--primario)">LEVEL: <span id="lvl">1</span></div>
    </div>

    <canvas id="raceCanvas" width="400" height="500"></canvas>

    <div style="margin-top:10px; font-size: 0.8rem; opacity:0.8;">USA ‚Üê ‚Üí O EL RAT√ìN PARA ESQUIVAR</div>
    
    <a href="../index.html" class="back-link">VOLVER AL MEN√ö</a>

    <script>
        const canvas = document.getElementById('raceCanvas');
        const ctx = canvas.getContext('2d');
        const distEl = document.getElementById('dist');
        const lvlEl = document.getElementById('lvl');

        let gameActive = true;
        let distance = 0;
        let speed = 5;
        let offset = 0;
        
        const car = { x: 200, y: 420, w: 40, h: 60 };
        let obstacles = [];
        let keys = {};

        window.onkeydown = (e) => keys[e.code] = true;
        window.onkeyup = (e) => keys[e.code] = false;
        canvas.onmousemove = (e) => {
            const rect = canvas.getBoundingClientRect();
            car.x = e.clientX - rect.left;
        };

        function spawnObstacle() {
            if (Math.random() < 0.05 + (speed/200)) {
                obstacles.push({
                    x: Math.random() * (canvas.width - 40),
                    y: -50,
                    w: 35,
                    h: 35,
                    color: Math.random() > 0.5 ? '#e91e63' : '#4caf50'
                });
            }
        }

        function update() {
            if (!gameActive) return;

            distance++;
            distEl.innerText = Math.floor(distance / 10);
            lvlEl.innerText = Math.floor(speed - 4);
            
            // Movimiento lateral
            if (keys['ArrowLeft'] && car.x > 20) car.x -= 7;
            if (keys['ArrowRight'] && car.x < canvas.width - 60) car.x += 7;

            // Mantener coche en l√≠mites
            if (car.x < 0) car.x = 0;
            if (car.x > canvas.width - car.w) car.x = canvas.width - car.w;

            // Carretera infinita (efecto visual)
            offset = (offset + speed) % 60;
            if (distance % 500 === 0) speed += 0.5;

            // Obst√°culos
            spawnObstacle();
            for (let i = obstacles.length - 1; i >= 0; i--) {
                obstacles[i].y += speed;

                // Colisi√≥n
                if (car.x < obstacles[i].x + obstacles[i].w &&
                    car.x + car.w > obstacles[i].x &&
                    car.y < obstacles[i].y + obstacles[i].h &&
                    car.y + car.h > obstacles[i].y) {
                    gameOver();
                }

                if (obstacles[i].y > canvas.height) obstacles.splice(i, 1);
            }
        }

        function draw() {
            // C√©sped
            ctx.fillStyle = "#102C26";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Carretera
            ctx.fillStyle = "#222";
            ctx.beginPath();
            ctx.moveTo(100, 0);
            ctx.lineTo(300, 0);
            ctx.lineTo(canvas.width, canvas.height);
            ctx.lineTo(0, canvas.height);
            ctx.fill();

            // L√≠neas de la carretera (Efecto movimiento)
            ctx.strokeStyle = "#F7EFCE";
            ctx.setLineDash([20, 40]);
            ctx.lineDashOffset = -offset * 2;
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(canvas.width/2, 0);
            ctx.lineTo(canvas.width/2, canvas.height);
            ctx.stroke();
            ctx.setLineDash([]);

            // Obst√°culos (Coches enemigos)
            obstacles.forEach(obs => {
                ctx.fillStyle = obs.color;
                ctx.fillRect(obs.x, obs.y, obs.w, obs.h);
                // Luces traseras
                ctx.fillStyle = "red";
                ctx.fillRect(obs.x + 5, obs.y + obs.h - 5, 5, 5);
                ctx.fillRect(obs.x + obs.w - 10, obs.y + obs.h - 5, 5, 5);
            });

            // Nuestro Coche (Crema y Rosa)
            ctx.fillStyle = "#F7EFCE";
            ctx.fillRect(car.x, car.y, car.w, car.h);
            ctx.fillStyle = "#e91e63"; // Techo rosa
            ctx.fillRect(car.x + 5, car.y + 15, car.w - 10, 25);
            // Luces delanteras
            ctx.fillStyle = "yellow";
            ctx.fillRect(car.x + 5, car.y, 8, 5);
            ctx.fillRect(car.x + car.w - 13, car.y, 8, 5);
        }

        function gameOver() {
            gameActive = false;
            alert("üí• ¬°PI√ëAZO! Has recorrido " + Math.floor(distance/10) + " metros.");
            location.reload();
        }

        function loop() {
            update();
            draw();
            requestAnimationFrame(loop);
        }

        loop();
    </script>
</body>
</html>
