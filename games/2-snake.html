<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Real | Suite</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">
    <style>
        :root {
            --fondo: #102C26;
            --tarjeta: #F7EFCE;
            --primario: #e91e63;
            --texto: #ffffff;
        }
        body { 
            background: var(--fondo); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            height: 100vh; 
            margin: 0; 
            font-family: 'Bungee', cursive; 
            overflow: hidden; 
            color: var(--tarjeta);
        }
        #header { 
            background: var(--primario); 
            width: 400px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 10px 20px; 
            border-radius: 15px 15px 0 0; 
            box-sizing: border-box;
            box-shadow: 0 -4px 0 rgba(0,0,0,0.2) inset;
        }
        .score-container { display: flex; align-items: center; color: white; font-size: 18px; }
        #game-container { position: relative; border: 10px solid var(--tarjeta); border-radius: 0 0 15px 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        canvas { background: #aad751; display: block; }
        .overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            background: rgba(16, 44, 38, 0.8); color: var(--tarjeta); display: none; 
        }
        button { 
            padding: 12px 25px; font-family: 'Bungee'; border: none; border-radius: 10px; 
            background: var(--primario); color: white; cursor: pointer; box-shadow: 4px 4px 0px #880e4f;
        }
        button:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px #880e4f; }
    </style>
</head>
<body>

    <div id="header">
        <div class="score-container">üçé <span id="currentScore">0</span></div>
        <div class="score-container">üèÜ <span id="highScore">0</span></div>
    </div>

    <div id="game-container">
        <canvas id="snakeGame" width="400" height="400"></canvas>
        <div id="overlay" class="overlay">
            <h1>¬°CASI!</h1>
            <button onclick="resetGame()">REINTENTAR</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('snakeGame');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('currentScore');
        const highScoreEl = document.getElementById('highScore');
        const overlay = document.getElementById('overlay');

        const grid = 20;
        let count = 0;
        let score = 0;
        let highScore = localStorage.getItem('snakeHS') || 0;
        highScoreEl.innerText = highScore;

        let snake = { x: 160, y: 160, dx: grid, dy: 0, cells: [], maxCells: 4 };
        let apple = { x: 320, y: 320 };

        function getRandomInt(min, max) { return Math.floor(Math.random() * (max - min)) + min; }

        function drawSnakePart(cell, index) {
            const isHead = index === 0;
            const isTail = index === snake.cells.length - 1;
            
            ctx.fillStyle = isHead ? '#2c3e50' : '#4572e6'; // Cabeza un poco m√°s oscura
            
            // Dibujar cuerpo redondeado
            let radius = isHead ? 8 : (isTail ? 4 : 6); // Se estrecha en la cola
            ctx.beginPath();
            ctx.roundRect(cell.x + 1, cell.y + 1, grid - 2, grid - 2, [radius]);
            ctx.fill();

            // Dibujar Ojos si es la cabeza
            if (isHead) {
                ctx.fillStyle = 'white';
                // Ojo izquierdo
                ctx.beginPath();
                ctx.arc(cell.x + 6, cell.y + 6, 3, 0, Math.PI * 2);
                ctx.fill();
                // Ojo derecho
                ctx.beginPath();
                ctx.arc(cell.x + 14, cell.y + 6, 3, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = 'black';
                // Pupila (basada en direcci√≥n)
                let px = snake.dx > 0 ? 1 : (snake.dx < 0 ? -1 : 0);
                let py = snake.dy > 0 ? 1 : (snake.dy < 0 ? -1 : 0);
                ctx.beginPath();
                ctx.arc(cell.x + 6 + px, cell.y + 6 + py, 1.5, 0, Math.PI * 2);
                ctx.arc(cell.x + 14 + px, cell.y + 6 + py, 1.5, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function loop() {
            if (overlay.style.display === 'flex') return;
            requestAnimationFrame(loop);
            if (++count < 6) return;
            count = 0;
            ctx.clearRect(0,0,canvas.width,canvas.height);

            // Tablero Damero (estilo Google)
            for (let i = 0; i < 20; i++) {
                for (let j = 0; j < 20; j++) {
                    ctx.fillStyle = (i + j) % 2 === 0 ? '#aad751' : '#a2d149';
                    ctx.fillRect(i * grid, j * grid, grid, grid);
                }
            }

            snake.x += snake.dx;
            snake.y += snake.dy;

            if (snake.x < 0 || snake.x >= canvas.width || snake.y < 0 || snake.y >= canvas.height) endGame();

            snake.cells.unshift({x: snake.x, y: snake.y});
            if (snake.cells.length > snake.maxCells) snake.cells.pop();

            // Dibujar Manzana
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(apple.x + grid/2, apple.y + grid/2, grid/2 - 2, 0, Math.PI * 2);
            ctx.fill();
            // Rabito de la manzana
            ctx.fillStyle = '#4a752c';
            ctx.fillRect(apple.x + grid/2 - 1, apple.y + 2, 2, 4);

            // Dibujar Serpiente
            snake.cells.forEach(drawSnakePart);

            // Colisi√≥n con manzana
            if (snake.x === apple.x && snake.y === apple.y) {
                snake.maxCells++;
                score++;
                scoreEl.innerText = score;
                apple.x = getRandomInt(0, 20) * grid;
                apple.y = getRandomInt(0, 20) * grid;
            }

            // Colisi√≥n con cuerpo
            for (let i = 1; i < snake.cells.length; i++) {
                if (snake.x === snake.cells[i].x && snake.y === snake.cells[i].y) endGame();
            }
        }

        function endGame() {
            overlay.style.display = 'flex';
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('snakeHS', highScore);
                highScoreEl.innerText = highScore;
            }
        }

        function resetGame() {
            snake = { x: 160, y: 160, dx: grid, dy: 0, cells: [], maxCells: 4 };
            score = 0; scoreEl.innerText = 0;
            apple = { x: getRandomInt(0, 20) * grid, y: getRandomInt(0, 20) * grid };
            overlay.style.display = 'none';
            requestAnimationFrame(loop);
        }

        document.addEventListener('keydown', function(e) {
            if (e.which === 37 && snake.dx === 0) { snake.dx = -grid; snake.dy = 0; }
            else if (e.which === 38 && snake.dy === 0) { snake.dy = -grid; snake.dx = 0; }
            else if (e.which === 39 && snake.dx === 0) { snake.dx = grid; snake.dy = 0; }
            else if (e.which === 40 && snake.dy === 0) { snake.dy = grid; snake.dx = 0; }
        });

        requestAnimationFrame(loop);
    </script>
</body>
</html>
